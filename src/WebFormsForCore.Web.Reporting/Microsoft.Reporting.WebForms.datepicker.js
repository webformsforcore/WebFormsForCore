function escapeProperlyCoreCore(n,t,i,r){var e="",f="",o=0,c=" \"%<>'&",s,u,h;if(typeof n=="undefined")return"";for(o=0;o<n.length;o++){if(u=n.charCodeAt(o),s=n.charAt(o),t&&(s=="#"||s=="?")){e+=n.substr(o);break}if(i&&s=="&"){e+=s;continue}u<=127?r?e+=s:u>=97&&u<=122||u>=65&&u<=90||u>=48&&u<=57||t&&u>=32&&u<=95&&c.indexOf(s)<0?e+=s:u<=15?e+="%0"+u.toString(16).toUpperCase():u<=127&&(e+="%"+u.toString(16).toUpperCase()):u<=2047?(f=UTF8_1ST_OF_2|u>>6,e+="%"+f.toString(16).toUpperCase(),f=UTF8_TRAIL|u&63,e+="%"+f.toString(16).toUpperCase()):(u&SURROGATE_6_BIT)!=HIGH_SURROGATE_BITS?(f=UTF8_1ST_OF_3|u>>12,e+="%"+f.toString(16).toUpperCase(),f=UTF8_TRAIL|(u&4032)>>6,e+="%"+f.toString(16).toUpperCase(),f=UTF8_TRAIL|u&63,e+="%"+f.toString(16).toUpperCase()):o<n.length-1&&(u=(u&1023)<<10,o++,h=n.charCodeAt(o),u|=h&1023,u+=SURROGATE_OFFSET,f=UTF8_1ST_OF_4|u>>18,e+="%"+f.toString(16).toUpperCase(),f=UTF8_TRAIL|(u&258048)>>12,e+="%"+f.toString(16).toUpperCase(),f=UTF8_TRAIL|(u&4032)>>6,e+="%"+f.toString(16).toUpperCase(),f=UTF8_TRAIL|u&63,e+="%"+f.toString(16).toUpperCase())}return e}function escapeProperly(n){return escapeProperlyCoreCore(n,!1,!1,!1)}function escapeProperlyCore(n,t){return escapeProperlyCoreCore(n,t,!1,!1)}function escapeUrlForCallback(n){var i=n.indexOf("#"),t=n.indexOf("?"),r;return i>0&&(t==-1||i<t)&&(r=n.substr(0,i),t>0&&(r+=n.substr(t)),n=r),escapeProperlyCoreCore(n,!0,!1,!0)}function PageUrlValidation(n){if(n.substr(0,4)!="http"&&n.substr(0,1)!="/"){var t="Invalid page URL: ";return alert(t+n),""}return n}function getOffsetTop(n,t){if(n==null)return t;if(n.tagName.toUpperCase()=="TD"&&n.runtimeStyle.borderTopStyle!="none"){var i=parseInt(n.runtimeStyle.borderTopWidth);isNaN(i)||(t+=i)}return getOffsetTop(n.offsetParent,n.offsetTop-n.scrollTop+t)}function getOffsetLeft(n,t){if(n==null)return t;if(n.tagName.toUpperCase()=="TD"&&n.runtimeStyle.borderLeftStyle!="none"){var i=parseInt(n.runtimeStyle.borderLeftWidth);isNaN(i)||(t+=i)}return getOffsetLeft(n.offsetParent,n.offsetLeft-n.scrollLeft+t)}function getDate(n,t){return n.value!=null?n.value:t}function PositionFrame(n){var t=document.getElementById(n),i=GetParentWindow(document).frameElement,r;if(i!=null&&t!=null&&(t.offsetWidth>0&&(i.style.width=t.offsetWidth+"px"),t.offsetHeight>0&&(i.style.height=t.offsetHeight+"px"),r=document.getElementById(g_currentID),r!=null)){try{r.focus()}catch(u){}return}}function HideUnhide(n,t,i,r){Hide(n),Unhide(t),PositionFrame(t),g_currentID=i,g_currentShowing=t;var u=document.getElementById(r);u!=null&&u.focus()}function datereplace(n,t,i){var r=new String(n),f=r.indexOf(t),u,e,o;return f!=-1?(u=r.substring(0,f),u+=i,e=r.indexOf("&",f),e!=-1&&(u+=r.substr(e+1)),u):(o=r.indexOf("?"),o==-1&&(r+="?"),r.charAt(r.length-1)!="&"&&(r+="&"),r+=i)}function MoveToDate(n,t){var i=document.location.href,r="date=";return i=datereplace(i,"Previous=",""),t&&(i=i+"&Previous=True"),timePortion!=null&&(n=n+timePortion),i=datereplace(i,r,"date="+escapeProperly(n)+"&"),document.location.replace(i),!0}function GetParentWindow(n){var t=n.parentWindow;return t||(t=n.defaultView),t}function OnKeyDown(n){var t=GetParentWindow(n.document).event,i=t.keyCode;switch(i){case 27:t.returnValue=!1,ClosePicker();break;case 38:t.returnValue=!1,MoveDays(-7);break;case 40:t.returnValue=!1,MoveDays(7);break;case 37:t.returnValue=!1,MoveDays(-1);break;case 39:t.returnValue=!1,MoveDays(1)}}function ClosePicker(){var n=GetParentWindow(document).frameElement;n!=null&&(n.resultfunc(),n.style.display="none",n=null)}function MoveDays(n){var t,i;if(g_currentID!=null&&!(g_currentID.length<6)){var u=g_currentID.substr(0,4)-0,f=g_currentID.substr(4,2)-0,r=g_currentID.substr(6,2)-0;if(!(r+n<1)&&(t=g_currentID.substr(0,6)+St2Digits(r+n),i=document.getElementById(t),i!=null)){g_currentID=t;try{i.focus()}catch(e){}}}}function St2Digits(n){var t="";return n<0?t:(n<10&&(t+="0"),t+=n)}function clickDatePicker(n,t,i){var e,u=document.getElementById(n),r,f,o;if(event!=null&&(event.cancelBubble=!0),n==null&&this.Picker!=null)this.Picker.style.display="none",this.Picker=null;else if(u!=null){if(f=document.getElementById(n),f!=null&&f.isDisabled)return;e=getDate(u,i),r=u.id,o=document.getElementById(r+g_strDatePickerImageID),clickDatePickerHelper(r,r+g_strDatePickerFrameID,o,e,t,OnSelectDate,OnPickerFinish),document.body.onclick=OnPickerFinish}}function clickDatePickerHelper(n,t,i,r,u,f,e){var h="",c,l;if((this.Picker!=null&&(this.Picker.style.display="none",h=this.Picker.resultfield.id,this.Picker.resultfunc!=null&&this.Picker.resultfunc(),this.Picker=null),h!=n)&&n!=null){if(this.Picker=document.getElementById(t),this.Picker==null)return;g_scrollLeft=document.body.scrollLeft,g_scrollTop=document.body.scrollTop,this.Picker.attachEvent("onreadystatechange",OnIframeLoadFinish),this.Picker.resultfield=document.getElementById(n),this.Picker.OnSelectDateCallback=f,this.Picker.resultfunc=e,c=PageUrlValidation(u)+escapeProperly(r),this.Picker.src=c;var a=getOffsetTop(i,1),o=getOffsetLeft(i,1),v=getOffsetTop(this.Picker.offsetParent,1),s=getOffsetLeft(this.Picker.offsetParent,1);this.Picker.style.pixelTop=a-v+i.offsetHeight+1,this.Picker.style.pixelRight=o-s+i.offsetWidth+1,this.Picker.currentStyle.direction=="rtl"?(l=this.Picker.offsetParent.offsetWidth,this.Picker.style.pixelLeft=o-s+i.offsetWidth+1,this.Picker.style.pixelLeft=l-this.Picker.style.pixelLeft):this.Picker.style.pixelRight=o-s+i.offsetWidth+1}}function ClickDay(n){var t=GetParentWindow(document).frameElement,i;return t==null?MoveToDate(n,!1):(OnSelectDate(t.resultfield,n),i=t.resultfunc,i(t.resultfield),!0)}function OnPickerFinish(){clickDatePicker(null,"","")}function OnSelectDate(n,t){timePortion!=null&&(t=t+timePortion);var i=n.attributes.getNamedItem("AutoPostBack"),r=i!=null&&i.value=="1"&&n.value!=t,u=n.value!=t;n.value=t,r&&window.setTimeout("__doPostBack('"+n.id+"','')",0)}function OnIframeLoadFinish(){this.Picker!=null&&this.Picker.readyState!=null&&this.Picker.readyState=="complete"&&(document.body.scrollLeft=g_scrollLeft,document.body.scrollTop=g_scrollTop,this.Picker.style.display="block",document.frames(this.Picker.id).focus())}function Hide(n){var t=document.getElementById(n);t!=null&&(t.style.display="none")}function Unhide(n){var t=document.getElementById(n);t!=null&&(t.style.display="block")}function ShowLoading(){Hide(g_currentShowing),Unhide("LoadingDiv")}var UTF8_1ST_OF_2=192,UTF8_1ST_OF_3=224,UTF8_1ST_OF_4=240,UTF8_TRAIL=128,HIGH_SURROGATE_BITS=55296,LOW_SURROGATE_BITS=56320,SURROGATE_6_BIT=64512,SURROGATE_ID_BITS=63488,SURROGATE_OFFSET=65536,g_currentID,g_currentShowing="DatePickerDiv",g_strDatePickerFrameID="DatePickerFrame",g_strDatePickerImageID="DatePickerImage",g_scrollLeft,g_scrollTop;