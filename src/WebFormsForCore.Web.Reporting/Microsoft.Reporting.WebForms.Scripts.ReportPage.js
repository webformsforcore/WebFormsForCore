Type.registerNamespace("Microsoft.Reporting.WebFormsClient"),Microsoft.Reporting.WebFormsClient._ReportPage=function(n){Microsoft.Reporting.WebFormsClient._ReportPage.initializeBase(this,[n]),this.TriggerSyncInteractivity=null,this.TriggerAsyncInteractivity=null,this.InteractivityMode=null,this.ActionTypeId=null,this.ActionParamId=null,this.SearchHitPrefix=null,this.m_nextSearchHit=1,this.NavigationId=null,this.PreviousViewNavigationAlignmentId=null,this.AvoidScrollChange=!1,this.AvoidScrollFromOrigin=!1,this.SpecificScrollPosition=null,this.HiddenZoomLevelId=null,this.LoadMessage=null,this.ReportDivId=null,this.ReportCellId=null,this.ScrollableContainerId=null,this.m_allContentLoaded=!1,this.m_loadDelegate=Function.createDelegate(this,this._PollForAllContentLoaded),this.ReportStyles=null,this.ReportPageStyles=null,this.StyleElementId=null,this.PrefixId=null,this.ScrollScript=null,this.m_fixedHeader=null,this.m_executingAction=null,this.m_toolbarUpdate=null,this.ConstFullPage="FullPage",this.ConstPageWidth="PageWidth",this.m_userCanceled=!1},Microsoft.Reporting.WebFormsClient._ReportPage.prototype={initialize:function(){Microsoft.Reporting.WebFormsClient._ReportPage.callBaseMethod(this,"initialize"),Sys.Application.add_load(this.m_loadDelegate)},dispose:function(){Sys.Application.remove_load(this.m_loadDelegate),delete this.m_loadDelegate,Microsoft.Reporting.WebFormsClient._ReportPage.callBaseMethod(this,"dispose")},set_ToolBarUpdate:function(n){this.m_toolbarUpdate=n},get_ToolBarUpdate:function(){return this.m_toolbarUpdate},add_allContentLoaded:function(n){this.get_events().addHandler("allContentLoaded",n)},remove_allContentLoaded:function(n){this.get_events().removeHandler("allContentLoaded",n)},IsLoading:function(){return!this.m_allContentLoaded},_OnUserCanceled:function(){this.m_userCanceled=!0},_PollForAllContentLoaded:function(){var n,i,t,r;if(this.m_userCanceled){this.ReportDivId&&(n=$get(this.ReportDivId),n&&(n.innerHTML=""));return}if(this.ReportDivId!=null&&(n=$get(this.ReportDivId),n))for(i=n.getElementsByTagName("IMG"),t=0;t<i.length;t++)if(r=i[t],!r.complete&&!r.errored){setTimeout(Function.createDelegate(this,this._PollForAllContentLoaded),250);return}this._OnAllContentLoaded()},_OnAllContentLoaded:function(){if(!this.m_allContentLoaded){this.m_allContentLoaded=!0;var n=this.get_events().getHandler("allContentLoaded");n&&n(this)}},OnReportVisible:function(){this._OutputStyleStream(),this._UpdateRenderer(),this._ApplyZoom(this.get_zoomLevel())},_OutputStyleStream:function(){var e=document.getElementsByTagName("HEAD"),t=null,r,o,u,i,f,n;e.length==0?(t=document.createElement("HEAD"),document.documentElement.insertBefore(t,document.documentElement.firstChild)):t=e[0],r=document.getElementById(this.StyleElementId),r!=null&&t.removeChild(r),this.ReportDivId&&(o=$get(this.ReportDivId),u=o.parentNode.id,u&&(i=this.ReportPageStyles,i||(i=""),f="#"+u+" { "+i+"}",this.ReportStyles?this.ReportStyles+=f:this.ReportStyles=f,this.ReportStyles+=" #"+this.ReportDivId+", #"+this.ReportDivId+" TABLE { font-family: Times New Roman; }")),this.ReportStyles!=null&&(n=document.createElement("STYLE"),n.type="text/css",n.id=this.StyleElementId,n.styleSheet!=null?n.styleSheet.cssText=this.ReportStyles:n.appendChild(document.createTextNode(this.ReportStyles)),t.appendChild(n))},OnReportScrolled:function(){this.LoadMessage!=null&&alert(this.LoadMessage)},InvokeReportAction:function(n,t){this._IsInputDisabled()||($get(this.ActionTypeId).value=n,$get(this.ActionParamId).value=this._TranslateAction(n,t),this.InteractivityMode==="AlwaysSynchronous"||this.InteractivityMode==="SynchronousOnDrillthrough"&&n==="Drillthrough"?this.TriggerSyncInteractivity():this.TriggerAsyncInteractivity())},HighlightNextSearchHit:function(){var t,n,i;if(this.SearchHitPrefix==null)return null;if(this.m_nextSearchHit>0)for(var t=this.SearchHitPrefix+(this.m_nextSearchHit-1),n=$get(t),i=0;n!=null;)n.style.backgroundColor="",n.style.color="",n=$get(t+"_"+ ++i);if(t=this.SearchHitPrefix+this.m_nextSearchHit,n=$get(t),n==null)return null;for(i=0;n!=null;)n.style.backgroundColor="highlight",n.style.color="highlighttext",n=$get(t+"_"+ ++i);return this.m_nextSearchHit++,t},_ApplyZoom:function(n){var t,i,f,r,u,e;if(this.ReportCellId!=null){if(t=$get(this.ReportCellId),n!=this.ConstPageWidth&&n!=this.ConstFullPage)t.style.zoom=n+"%";else{if(i=$get(this.ScrollableContainerId),i==null||i.style.overflow!="auto")return;if(n!=this.ConstPageWidth)t.offsetWidth*i.offsetHeight<t.offsetHeight*i.offsetWidth?this._ApplyCalculatedZoom(t,i.offsetHeight,t.offsetHeight):this._ApplyCalculatedZoom(t,i.offsetWidth,t.offsetWidth);else for(f=i.offsetHeight!=i.clientHeight,r=t.offsetWidth>0,u=0;u<=1&r;++u)n=this._ApplyCalculatedZoom(t,i.clientWidth,t.offsetWidth),r=f!=t.offsetHeight*n>i.offsetHeight}Microsoft_ReportingServices_HTMLRenderer_ScaleImageUpdateZoom&&_$RVCommon.isPreIE8StandardsMode()&&(e=new Microsoft_ReportingServices_HTMLRenderer_FitProportional,e.ResizeImages(this.ReportDivId,this.ReportCellId),Microsoft_ReportingServices_HTMLRenderer_ScaleImageUpdateZoom(this.PrefixId,this.ReportDivId,this.ReportCellId)),this.OnScroll()}},_ApplyCalculatedZoom:function(n,t,i){if(i<=0)return 1;var r=(t-1)/i;return n.style.zoom=r,r},GetCurrentZoomFactor:function(){return this.GetZoomFromReportCell(this.ReportCellId)},GetZoomFromReportCell:function(n){var u=$get(n),i,t,r;if(u){if(i=u.style.zoom,i==null)return 1;if(typeof i=="number")return i;if(t=String(i),t!="")return t.charAt(t.length-1)==="%"?(t=t.substr(0,t.length-1),t/100):(r=parseFloat(t),r!=null?r:1)}return 1},get_zoomLevel:function(){var n=$get(this.HiddenZoomLevelId);return n.value},set_zoomLevel:function(n){var t,i;if(n!=this.ConstPageWidth&&n!=this.ConstFullPage)if(t=parseInt(n,10),isNaN(t)||t<=0)throw Error.argumentOutOfRange("zoomLevel",n,"The zoom level must be a positive integer or '"+this.ConstPageWidth+"' or '"+this.ConstFullPage+"'.");else n=t;this._ApplyZoom(n),i=$get(this.HiddenZoomLevelId),i.value=n},_UpdateRenderer:function(){if(this.ReportDivId){var n=new Microsoft_ReportingServices_HTMLRenderer_FitProportional;n.ResizeImages(this.ReportDivId,this.ReportCellId),Microsoft_ReportingServices_HTMLRenderer_ScaleImageConsolidation&&Microsoft_ReportingServices_HTMLRenderer_ScaleImageConsolidation(this.PrefixId,this.ReportDivId,this.ReportCellId),Microsoft_ReportingServices_HTMLRenderer_ScaleImageForFit&&Microsoft_ReportingServices_HTMLRenderer_ScaleImageForFit(this.PrefixId,this.ReportDivId),Microsoft_ReportingServices_HTMLRenderer_GrowRectangles&&Microsoft_ReportingServices_HTMLRenderer_GrowRectangles(this.PrefixId,this.ReportDivId),Microsoft_ReportingServices_HTMLRenderer_FitVertText&&Microsoft_ReportingServices_HTMLRenderer_FitVertText(this.PrefixId,this.ReportDivId)}},OnScroll:function(){if(this.ScrollScript){var n=!this.m_fixedHeader;n&&(this.m_fixedHeader=new Microsoft_ReportingServices_HTMLRenderer_FixedHeader(this.ReportDivId,this.ReportCellId,$get(this.ReportDivId).parentNode.id,this.PrefixId)),this.ScrollScript(n)}},EnableDisableInput:function(n){this.m_executingAction=n?null:!0},_IsInputDisabled:function(){return this.m_executingAction==!0},_TranslateAction:function(n,t){var i;return i=n=="Sort"?window.event&&window.event.shiftKey?t+"_T":t+"_F":t}},Microsoft.Reporting.WebFormsClient._ReportPage.registerClass("Microsoft.Reporting.WebFormsClient._ReportPage",Sys.UI.Control);